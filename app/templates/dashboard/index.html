{% extends "layout.html" %}

{% block title %}Dashboard - PreIncubadora AI{% endblock %}

{% block content %}
<div class="space-y-8">
    <!-- Encabezado -->
    <div class="flex flex-col md:flex-row md:items-center md:justify-between">
        <div>
            <h1 class="text-3xl font-bold text-white">Dashboard</h1>
            <p class="text-slate-400 mt-2">Gestiona tus proyectos y análisis de viabilidad</p>
        </div>
        
        {% if can_create_project %}
        <a href="/project/create" class="mt-4 md:mt-0 btn-primary text-white font-semibold py-2 px-6 rounded-lg hover:opacity-90 transition inline-block">
            + Nuevo Proyecto
        </a>
        {% else %}
        <div class="mt-4 md:mt-0 bg-orange-900 bg-opacity-50 border border-orange-600 text-orange-300 px-4 py-2 rounded-lg text-sm">
            Límite diario alcanzado (máx. 2 proyectos/24h)
        </div>
        {% endif %}
    </div>
    
    <!-- Proyectos -->
    {% if projects %}
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for project in projects %}
        <div class="card p-6 hover:border-blue-500 transition cursor-pointer group">
            <a href="/project/{{ project.id }}" class="block h-full">
                <!-- Estado Badge -->
                <div class="flex items-start justify-between mb-4">
                    <h3 class="text-lg font-semibold text-white group-hover:text-blue-400 transition flex-1">
                        {{ project.title }}
                    </h3>
                    <span class="text-xs px-3 py-1 rounded-full
                        {% if project.status == 'ambiguous' %}
                            bg-yellow-900 bg-opacity-50 text-yellow-300
                        {% elif project.status == 'ready' %}
                            bg-green-900 bg-opacity-50 text-green-300
                        {% elif project.status == 'in_analysis' %}
                            bg-blue-900 bg-opacity-50 text-blue-300
                        {% else %}
                            bg-purple-900 bg-opacity-50 text-purple-300
                        {% endif %}
                    ">
                        {{ project.status }}
                    </span>
                </div>
                
                <!-- Idea preview -->
                <p class="text-slate-400 text-sm line-clamp-2 mb-4">
                    {{ project.raw_idea[:100] }}...
                </p>
                
                <!-- Variability Score -->
                <div class="mb-4">
                    <div class="flex justify-between items-center mb-2">
                        <span class="text-xs text-slate-500">Ambigüedad</span>
                        <span class="text-xs font-semibold text-slate-300">{{ "%.1f"|format(project.variability_score) }}%</span>
                    </div>
                    <div class="h-2 bg-slate-700 rounded-full overflow-hidden">
                        <div class="h-full rounded-full transition-all"
                            style="width: {{ project.variability_score }}%;
                            {% if project.variability_score < 33 %}
                                background-color: #10b981;
                            {% elif project.variability_score < 67 %}
                                background-color: #f59e0b;
                            {% else %}
                                background-color: #ef4444;
                            {% endif %}">
                        </div>
                    </div>
                </div>
                
                <!-- Fecha -->
                <div class="text-xs text-slate-500">
                    Creado: {{ project.created_at.strftime('%d/%m/%Y') }}
                </div>
            </a>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="card p-12 text-center">
        <div class="w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4">
            <svg class="w-8 h-8 text-slate-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
        </div>
        <h3 class="text-lg font-semibold text-white mb-2">No hay proyectos aún</h3>
        <p class="text-slate-400 mb-6">Crea tu primer proyecto para comenzar el análisis de viabilidad</p>
        {% if can_create_project %}
        <a href="/project/create" class="btn-primary text-white font-semibold py-2 px-6 rounded-lg hover:opacity-90 transition inline-block">
            Crear primer proyecto
        </a>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
